# Deployment Guide ðŸš€

This bot is ready to be deployed to the cloud. We recommend **Railway** for the easiest setup because it natively supports the bot's "polling" mode.

## 1. Prerequisites
- **GitHub Account**: To host your code.
- **Railway Account** ([railway.app](https://railway.app)): To run the bot.
- **Supabase Account** ([supabase.com](https://supabase.com)): For the database.
- **Telegram Bot Token**: From @BotFather.

---

## 2. Database Setup (Supabase) ðŸ—„ï¸
Since cloud platforms (like Railway) are ephemeral, you cannot use the local `bot.db` file. You must use Supabase.

1.  Create a new project on **Supabase**.
2.  Go to the **SQL Editor** (left sidebar).
3.  Paste and run the following SQL to create your tables:

```sql
-- Users & Settings
CREATE TABLE IF NOT EXISTS user_settings (
    user_id BIGINT PRIMARY KEY,
    interest TEXT,
    language TEXT DEFAULT 'en'
);

-- Queue
CREATE TABLE IF NOT EXISTS waiting_queue (
    user_id BIGINT PRIMARY KEY,
    interest TEXT
);

-- Active Chats
CREATE TABLE IF NOT EXISTS active_chats (
    user_id BIGINT PRIMARY KEY,
    partner_id BIGINT
);

-- Blocked Users
CREATE TABLE IF NOT EXISTS blocked_users (
    user_id BIGINT,
    blocked_user_id BIGINT,
    PRIMARY KEY (user_id, blocked_user_id)
);

-- Reports
CREATE TABLE IF NOT EXISTS reports (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    reporter_id BIGINT,
    reported_id BIGINT,
    reason TEXT,
    timestamp TIMESTAMPTZ DEFAULT NOW()
);

-- Message Logs
CREATE TABLE IF NOT EXISTS message_logs (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    sender_id BIGINT,
    sender_msg_id BIGINT,
    receiver_id BIGINT,
    receiver_msg_id BIGINT,
    timestamp TIMESTAMPTZ DEFAULT NOW()
);
```

4.  Go to **Project Settings > API** and copy:
    - `Project URL`
    - `service_role` secret key (Use `service_role` to bypass RLS for the bot).

---

## 3. Deploy to Railway ðŸš…

1.  **Push your code to GitHub**.
2.  Login to **Railway** and click **"New Project"** -> **"Deploy from GitHub repo"**.
3.  Select your repository.
4.  Railway will detect the `Procfile` and start building.
5.  Go to **Variables** tab and add:
    - `BOT_TOKEN`: Your Telegram Bot Token.
    - `SUPABASE_URL`: Your Supabase Project URL.
    - `SUPABASE_KEY`: Your Supabase `service_role` key.
    - `DB_TYPE`: `supabase` (Critical!).
    - `ADMIN_IDS`: `123456789` (Your Telegram ID).
6.  Railway will automatically redeploy. Once it says "Active", your bot is live!

---

## 4. Why not Vercel? ðŸ¤”
Vercel is designed for **Websites** (short-lived requests), not **Bots** (long-running processes).
- **Railway**: Runs your bot 24/7 (Worker mode). Perfect for `python bot.py`.
- **Vercel**: Kills your bot after 10 seconds. To use Vercel, you would need to rewrite the bot to use Webhooks, which is more complex to set up.

**Recommendation**: Stick with **Railway** for a hassle-free experience.
